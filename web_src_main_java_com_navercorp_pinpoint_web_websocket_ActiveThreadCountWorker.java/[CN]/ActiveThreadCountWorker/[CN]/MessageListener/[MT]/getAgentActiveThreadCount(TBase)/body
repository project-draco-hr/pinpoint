{
  AgentActiveThreadCount agentActiveThreadCount=new AgentActiveThreadCount(agentInfo.getAgentId());
  if (routeResponse != null && (routeResponse instanceof TCommandTransferResponse)) {
    byte[] payload=((TCommandTransferResponse)routeResponse).getPayload();
    TBase<?,?> activeThreadCountResponse=agentService.deserializeResponse(payload,null);
    if (activeThreadCountResponse != null && (activeThreadCountResponse instanceof TCmdActiveThreadCountRes)) {
      agentActiveThreadCount.setResult((TCmdActiveThreadCountRes)activeThreadCountResponse);
    }
 else {
      agentActiveThreadCount.setFail("ROUTE_ERROR:" + TRouteResult.NOT_SUPPORTED_RESPONSE.name());
    }
  }
 else {
    agentActiveThreadCount.setFail("ROUTE_ERROR:" + TRouteResult.BAD_RESPONSE.name());
  }
  return agentActiveThreadCount;
}
