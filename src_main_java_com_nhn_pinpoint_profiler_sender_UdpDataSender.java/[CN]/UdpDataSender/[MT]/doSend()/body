{
  drain:   while (true) {
    try {
      if (isShutdown()) {
        break;
      }
      Collection<Object> dtoList=takeN();
      if (dtoList != null) {
        sendPacketN(dtoList);
        continue;
      }
      while (true) {
        if (isShutdown()) {
          break;
        }
        Object dto=takeOne();
        if (dto != null) {
          sendPacket(dto);
          continue drain;
        }
      }
    }
 catch (    Throwable th) {
      logger.warn("UdpSenderLoop->Unexpected Error. Cause:{}",th.getMessage(),th);
    }
  }
  flushQueue();
}
