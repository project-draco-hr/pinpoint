{
  if (result.isEmpty()) {
    return Collections.emptyList();
  }
  byte[] rowKey=result.getRow();
  final TransactionId transactionId=newTransactionId(rowKey,DISTRIBUTE_HASH_SIZE);
  final Cell[] rawCells=result.rawCells();
  final List<Object> out=new ArrayList<>(rawCells.length);
  final SpanDecodingContext decodingContext=new SpanDecodingContext();
  decodingContext.setTransactionId(transactionId);
  for (  Cell cell : rawCells) {
    SpanDecoder spanDecoder=null;
    if (CellUtil.matchingFamily(cell,HBaseTables.TRACE_V2_CF_SPAN)) {
      decodingContext.setCollectorAcceptedTime(cell.getTimestamp());
      final Buffer qualifier=new OffsetFixedBuffer(cell.getQualifierArray(),cell.getQualifierOffset(),cell.getQualifierLength());
      final Buffer columnValue=new OffsetFixedBuffer(cell.getValueArray(),cell.getValueOffset(),cell.getValueLength());
      spanDecoder=resolveDecoder(columnValue);
      spanDecoder.decode(qualifier,columnValue,decodingContext,out);
    }
 else {
      logger.warn("Unknown ColumnFamily :{}",Bytes.toStringBinary(CellUtil.cloneFamily(cell)));
    }
    nextCell(spanDecoder,decodingContext);
  }
  decodingContext.finish();
  return buildSpanBoList(out);
}
