{
  if (result.isEmpty()) {
    return Collections.emptyMap();
  }
  final Cell[] rawCells=result.rawCells();
  Map<Long,List<AnnotationBo>> annotationList=new HashMap<>();
  for (  Cell cell : rawCells) {
    final Buffer buffer=new OffsetFixedBuffer(cell.getQualifierArray(),cell.getQualifierOffset(),cell.getQualifierLength());
    long spanId=buffer.readLong();
    if (CellUtil.matchingFamily(cell,HBaseTables.TRACES_CF_ANNOTATION)) {
      final int valueLength=cell.getValueLength();
      if (valueLength == 0) {
        continue;
      }
      buffer.setOffset(cell.getValueOffset());
      List<AnnotationBo> annotationBoList=annotationDecoder.decode(buffer);
      if (CollectionUtils.isNotEmpty(annotationBoList)) {
        annotationList.put(spanId,annotationBoList);
      }
    }
  }
  return annotationList;
}
