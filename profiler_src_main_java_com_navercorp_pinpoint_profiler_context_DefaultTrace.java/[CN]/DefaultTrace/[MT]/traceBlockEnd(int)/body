{
  final SpanEvent spanEvent=callStack.pop();
  if (spanEvent == null) {
    if (logger.isWarnEnabled()) {
      PinpointException exception=new PinpointException("Corrupted CallStack found");
      logger.warn("Corrupted CallStack found. stack is empty. expected:{} current:null",stackId,exception);
    }
    return;
  }
  if (spanEvent.getStackId() != stackId) {
    if (logger.isWarnEnabled()) {
      PinpointException exception=new PinpointException("Corrupted CallStack found");
      logger.warn("Corrupted CallStack found. StackId not matched. expected:{} current:{}",stackId,spanEvent.getStackId(),exception);
    }
  }
  spanEvent.markAfterTime();
  logSpan(spanEvent);
}
