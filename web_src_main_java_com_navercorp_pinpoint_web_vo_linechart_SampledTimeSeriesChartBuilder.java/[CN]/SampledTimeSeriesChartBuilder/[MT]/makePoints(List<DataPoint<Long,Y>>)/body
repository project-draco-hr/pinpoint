{
  Points points=new Points();
  allocateDataPoints(dataPoints);
  int timeSlotIndex=0;
  for (  Long timestamp : this.timeWindow) {
    List<Y> samples=this.timeslots.get(timeSlotIndex);
    Point point=new Point(timestamp,sampleMin(samples),sampleMax(samples),sampleAvg(samples));
    points.addPoint(point);
    ++timeSlotIndex;
  }
  return points;
}
