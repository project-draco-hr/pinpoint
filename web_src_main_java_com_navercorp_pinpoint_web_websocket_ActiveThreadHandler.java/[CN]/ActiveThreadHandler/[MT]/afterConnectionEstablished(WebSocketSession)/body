{
  logger.info("ConnectionEstablished : {}",newSession);
  List<NameValuePair> params=URLEncodedUtils.parse(newSession.getUri(),"UTF-8");
  String applicationName=getValue(params,APPLICATION_NAME_KEY);
  if (applicationName == null) {
    logger.warn("Connection established refused. required parameter is missiong({}).",APPLICATION_NAME_KEY);
    newSession.close(CloseStatus.POLICY_VIOLATION);
  }
  newSession.getAttributes().put(APPLICATION_NAME_KEY,applicationName);
  writeLock.lock();
  try {
    List<WebSocketSession> webSocketSessions=applicationGroup.get(applicationName);
    if (webSocketSessions == null) {
      webSocketSessions=new ArrayList<WebSocketSession>();
      applicationGroup.put(applicationName,webSocketSessions);
    }
    webSocketSessions.add(newSession);
    if (timer == null) {
      timer=timerFactory.createHashedWheelTimer(threadFactory,100,TimeUnit.MILLISECONDS,512);
      Timeout timeout=timer.newTimeout(new ActiveThreadTimerTask(),time,TimeUnit.MILLISECONDS);
    }
  }
  finally {
    writeLock.unlock();
  }
  super.afterConnectionEstablished(newSession);
}
