{
  String[] agentIdList=applicationIndexDao.selectAgentIds(applicationName);
  if (agentIdList == null || agentIdList.length == 0) {
    logger.debug("agentIdList is empty. applicationName={}, from={}",applicationName,from);
    return new TreeMap<String,List<AgentInfoBo>>();
  }
  logger.debug("agentIdList={}",Arrays.toString(agentIdList));
  SortedMap<String,List<AgentInfoBo>> result=new TreeMap<String,List<AgentInfoBo>>();
  for (  String agentId : agentIdList) {
    List<AgentInfoBo> agentInfoList=agentInfoDao.getAgentInfo(agentId,from);
    if (agentInfoList.isEmpty()) {
      logger.debug("agentinfolist is empty. agentid={}, from={}",agentId,from);
      continue;
    }
    AgentInfoBo agentInfo=agentInfoList.get(0);
    String hostname=agentInfo.getHostname();
    if (result.containsKey(hostname)) {
      result.get(hostname).add(agentInfo);
    }
 else {
      List<AgentInfoBo> list=new ArrayList<AgentInfoBo>();
      list.add(agentInfo);
      result.put(hostname,list);
    }
  }
  for (  Entry<String,List<AgentInfoBo>> entry : result.entrySet()) {
    Collections.sort(entry.getValue());
  }
  logger.info("getApplicationAgentList={}",result);
  return result;
}
