{
  logger.info("Received RequestPacket {} {}.",requestPacket,channel);
  TBase<?,?> request=deserialize(requestPacket.getPayload());
  if (request == null) {
    TResult tResult=new TResult(false);
    tResult.setMessage("Unexpected decode result.");
    channel.write(new ResponsePacket(requestPacket.getRequestId(),serialize(tResult)));
  }
 else   if (request instanceof TCommandTransfer) {
    String applicationName=((TCommandTransfer)request).getApplicationName();
    String agentId=((TCommandTransfer)request).getAgentId();
    byte[] payload=((TCommandTransfer)request).getPayload();
    TBase command=deserialize(payload);
    ChannelContext channelContext=profilerClusterPoint.getChannelContext(applicationName,agentId,-1);
    Map<Object,Object> proeprties=channelContext.getChannelProperties();
    String version=MapUtils.getString(proeprties,AgentPropertiesType.VERSION.getName());
    TCommandTypeVersion commandVersion=TCommandTypeVersion.getVersion(version);
    if (commandVersion.isSupportCommand(command)) {
      Future<ResponseMessage> future=channelContext.getSocketChannel().sendRequestMessage(payload);
      future.await();
      ResponseMessage responseMessage=future.getResult();
      channel.write(new ResponsePacket(requestPacket.getRequestId(),responseMessage.getMessage()));
    }
 else {
      TResult result=new TResult(false);
      result.setMessage(applicationName + "/" + agentId+ " unsupported command("+ command+ ") type.");
      channel.write(new ResponsePacket(requestPacket.getRequestId(),serialize(result)));
    }
  }
 else {
    TResult tResult=new TResult(false);
    tResult.setMessage("Unsupported command(" + request + ") type.");
    channel.write(new ResponsePacket(requestPacket.getRequestId(),serialize(tResult)));
  }
}
