{
  try {
    logger.info("ActiveThreadTimerTask started.");
    Map<String,List<WebSocketSession>> applicationGroup=createApplicationGroup(sessionRepository);
    for (    Map.Entry<String,List<WebSocketSession>> applicationEntry : applicationGroup.entrySet()) {
      String applicationName=applicationEntry.getKey();
      List<AgentInfo> agentInfoList=getAgentInfoList(applicationName);
      AgentActiveThreadCountList agentActiveThreadCountList=getAgentActiveThreadCount(agentInfoList);
      doResponse(applicationEntry.getValue(),applicationName,agentActiveThreadCountList);
    }
  }
  finally {
    if (timer != null && onTimerTask.get()) {
      timer.newTimeout(new ActiveThreadTimerTask(),time,TimeUnit.MILLISECONDS);
    }
  }
}
