{
  logger.info("ConnectionEstablished. session:{}",newSession);
synchronized (lock) {
    newSession.getAttributes().put(HEALTH_CHECK_WAIT_KEY,new AtomicBoolean(false));
    sessionRepository.add(newSession);
    boolean turnOn=onTimerTask.compareAndSet(false,true);
    if (turnOn) {
      flushTimer.newTimeout(new ActiveThreadTimerTask(),flushDelay,TimeUnit.MILLISECONDS);
      healthCheckTimer.newTimeout(new HealthCheckTimerTask(),DEFAULT_HEALTH_CHECk_DELAY,TimeUnit.MILLISECONDS);
    }
  }
  super.afterConnectionEstablished(newSession);
}
