{
  DefaultTraceContext defaultTraceContext=new DefaultTraceContext(new TestAgentInformation());
  DefaultTrace trace=new DefaultTrace(defaultTraceContext,1);
  trace.setStorage(new SpanStorage(LoggingDataSender.DEFAULT_LOGGING_DATA_SENDER));
  Assert.assertEquals(0,trace.getCallStackDepth());
  trace.traceBlockBegin();
  Assert.assertEquals(1,trace.getCallStackDepth());
  trace.traceBlockBegin();
  Assert.assertEquals(2,trace.getCallStackDepth());
  trace.traceBlockEnd();
  Assert.assertEquals(1,trace.getCallStackDepth());
  trace.traceBlockEnd();
  Assert.assertEquals(0,trace.getCallStackDepth());
  trace.traceRootBlockEnd();
}
