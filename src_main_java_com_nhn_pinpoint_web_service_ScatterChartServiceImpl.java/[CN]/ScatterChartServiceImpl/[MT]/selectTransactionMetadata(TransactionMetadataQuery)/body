{
  List<List<SpanBo>> selectedSpans=traceDao.selectSpans(query.getTraceIds());
  List<SpanBo> result=new ArrayList<SpanBo>(query.size());
  for (  List<SpanBo> spans : selectedSpans) {
    for (    SpanBo span : spans) {
      if (query.isExists(span.getTraceAgentId(),span.getTraceAgentStartTime(),span.getTraceTransactionSequence(),span.getCollectorAcceptTime(),span.getElapsed())) {
        result.add(span);
      }
    }
  }
  Collections.sort(result,spanComparator);
  return result;
}
