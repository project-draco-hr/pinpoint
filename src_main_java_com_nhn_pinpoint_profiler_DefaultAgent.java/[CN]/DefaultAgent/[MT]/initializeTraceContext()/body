{
  this.traceContext=new DefaultTraceContext();
  this.traceContext.setAgentId(this.agentId);
  this.traceContext.setApplicationId(this.applicationName);
  this.traceContext.setAgentStartTime(this.startTime);
  this.traceContext.setPriorityDataSender(this.priorityDataSender);
  Sampler sampler=createSampler();
  logger.info("SamplerType:{}",sampler.getClass());
  this.traceContext.setSampler(sampler);
  if (profilerConfig.isSamplingElapsedTimeBaseEnable()) {
    TimeBaseStorageFactory timeBaseStorageFactory=new TimeBaseStorageFactory(this.dataSender,this.profilerConfig);
    this.traceContext.setStorageFactory(timeBaseStorageFactory);
  }
 else {
    this.traceContext.setStorageFactory(new BypassStorageFactory(dataSender));
  }
}
