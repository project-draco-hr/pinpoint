{
  if (!isRun()) {
    return;
  }
  logger.debug("write RegisterAgentPacket {}",channel);
  byte[] payload;
  try {
    Map properties=this.pinpointSocketFactory.getAgentProperties();
    payload=ControlMessageEnDeconderUtils.encode(properties);
    ControlRegisterAgentPacket packet=new ControlRegisterAgentPacket(payload);
    ChannelFuture write=this.channel.write(packet);
  }
 catch (  ProtocolException e) {
    logger.warn(e.getMessage(),e);
  }
}
