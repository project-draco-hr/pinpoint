{
  ThriftPluginConfig config=new ThriftPluginConfig(context.getConfig());
  context.setAttribute(ATTRIBUTE_CONFIG,config);
  boolean traceClient=config.traceThriftClient();
  boolean traceProcessor=config.traceThriftProcessor();
  boolean traceCommon=traceClient || traceProcessor;
  if (traceClient) {
    addInterceptorsForSynchronousClients(context);
    addInterceptorsForAsynchronousClients(context);
  }
  if (traceProcessor) {
    addInterceptorsForSynchronousProcessors(context);
    addInterceptorsForAsynchronousProcessors(context);
  }
  if (traceCommon) {
    addInterceptorsForRetrievingSocketAddresses(context);
    addTProtocolEditors(context);
  }
}
