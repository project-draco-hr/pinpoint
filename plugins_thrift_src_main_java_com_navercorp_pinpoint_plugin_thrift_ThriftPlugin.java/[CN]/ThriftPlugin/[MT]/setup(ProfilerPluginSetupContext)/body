{
  ThriftPluginConfig config=new ThriftPluginConfig(context.getConfig());
  boolean traceClient=config.traceThriftClient();
  boolean traceProcessor=config.traceThriftProcessor();
  boolean traceCommon=traceClient || traceProcessor;
  if (traceClient) {
    addInterceptorsForSynchronousClients(config);
    addInterceptorsForAsynchronousClients();
  }
  if (traceProcessor) {
    addInterceptorsForSynchronousProcessors();
    addInterceptorsForAsynchronousProcessors();
  }
  if (traceCommon) {
    addInterceptorsForRetrievingSocketAddresses();
    addTProtocolEditors(config);
  }
}
