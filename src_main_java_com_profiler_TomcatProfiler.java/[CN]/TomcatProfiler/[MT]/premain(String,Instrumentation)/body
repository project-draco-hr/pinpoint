{
  if (agentArgs != null) {
    logger.info("HIPPO agentArgs:" + agentArgs);
  }
  ClassPathResolver classPathResolver=new ClassPathResolver();
  boolean agentJarNotFound=classPathResolver.findAgentJar();
  if (!agentJarNotFound) {
    logger.severe("hippo-tomcat-profiler-x.x.x.jar not found.");
    return;
  }
  List<URL> libUrlList=resolveLib(classPathResolver);
  AgentClassLoader agentClassLoader=new AgentClassLoader(libUrlList.toArray(new URL[libUrlList.size()]));
  agentClassLoader.setBootClass("com.profiler.boot.BootClassTest");
  try {
    agentClassLoader.boot();
  }
 catch (  Exception e) {
    logger.info("test error");
    e.printStackTrace();
  }
  try {
    ProfilerConfig profilerConfig=readConfig(classPathResolver);
    if (!profilerConfig.isProfileEnable()) {
      logger.warning("Profiler Agent not started. profile.enable=" + profilerConfig.isProfileEnable());
      return;
    }
    Agent agent=new Agent(profilerConfig);
    new TomcatProfiler(agentArgs,instrumentation,agent,profilerConfig);
  }
 catch (  Exception e) {
    logger.log(Level.SEVERE,"Profiler Agent start fail. Cause:" + e.getMessage(),e);
  }
}
