{
  if (isDebug) {
    LoggingUtils.logBefore(logger,target,className,methodName,parameterDescription,args);
  }
  try {
    traceContext.getActiveThreadCounter().start();
    HttpServletRequest request=(HttpServletRequest)args[0];
    String requestURL=request.getRequestURI();
    String remoteAddr=request.getRemoteAddr();
    TraceID traceId=populateTraceIdFromRequest(request);
    DefaultTrace trace;
    if (traceId != null) {
      if (logger.isLoggable(Level.INFO)) {
        logger.info("TraceID exist. continue trace. " + traceId);
        logger.log(Level.FINE,"requestUrl:" + requestURL + ", remoteAddr:"+ remoteAddr);
      }
      trace=new DefaultTrace(traceId);
      traceContext.attachTraceObject(trace);
    }
 else {
      trace=new DefaultTrace();
      if (logger.isLoggable(Level.INFO)) {
        logger.info("TraceID not exist. start new trace. " + trace.getTraceId());
        logger.log(Level.FINE,"requestUrl:" + requestURL + ", remoteAddr:"+ remoteAddr);
      }
      traceContext.attachTraceObject(trace);
    }
    trace.markBeforeTime();
    trace.recordServiceType(ServiceType.TOMCAT);
    trace.recordRpcName(requestURL);
    int port=request.getServerPort();
    trace.recordEndPoint(request.getServerName() + ((port > 0) ? ":" + port : ""));
    trace.recordRemoteAddr(remoteAddr);
    if (traceId != null && !traceId.isRoot()) {
      String parentApplicationName=populateParentApplicationNameFromRequest(request);
      short parentApplicationType=populateParentApplicationTypeFromRequest(request);
      if (parentApplicationName != null) {
        trace.recordParentApplication(parentApplicationName,parentApplicationType);
        trace.recordAcceptorHost(NetworkUtils.getHostFromURL(request.getRequestURL().toString()));
      }
    }
 else {
    }
  }
 catch (  Exception e) {
    if (logger.isLoggable(Level.WARNING)) {
      logger.log(Level.WARNING,"Tomcat StandardHostValve trace start fail. Caused:" + e.getMessage(),e);
    }
  }
}
