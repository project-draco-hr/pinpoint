{
  TBase<?,?> tBase;
  if (dto instanceof TBase) {
    tBase=(TBase<?,?>)dto;
  }
 else   if (dto instanceof Thriftable) {
    tBase=((Thriftable)dto).toThrift();
  }
 else {
    logger.warn("sendPacket fail. invalid type:" + dto.getClass());
    return;
  }
  byte[] sendData=serialize(tBase);
  if (sendData == null) {
    logger.warn("sendData is null");
    return;
  }
  DatagramPacket packet=new DatagramPacket(sendData,sendData.length);
  try {
    udpSocket.send(packet);
    if (logger.isInfoEnabled()) {
      logger.info("Data sent. " + dto);
    }
  }
 catch (  IOException e) {
    logger.warn("packet send error " + dto,e);
  }
}
