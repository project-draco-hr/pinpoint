{
  MetricRegistry r=registry.getRegistry();
  TStatWithSerialCollector stat=(TStatWithSerialCollector)typeObject;
  if (stat == null) {
    stat=new TStatWithSerialCollector();
    agentStat.setSerial(stat);
  }
  stat.setAgentId(agentId);
  stat.setTimestamp(System.currentTimeMillis());
  stat.setJvmMemoryTotalMax(MetricMonitorValues.getLong(r,JVM_MEMORY_TOTAL_MAX));
  stat.setJvmMemoryTotalUsed(MetricMonitorValues.getLong(r,JVM_MEMORY_TOTAL_USED));
  stat.setJvmMemoryHeapMax(MetricMonitorValues.getLong(r,JVM_MEMORY_HEAP_MAX));
  stat.setJvmMemoryHeapUsed(MetricMonitorValues.getLong(r,JVM_MEMORY_HEAP_USED));
  stat.setJvmMemoryNonHeapMax(MetricMonitorValues.getLong(r,JVM_MEMORY_NONHEAP_MAX));
  stat.setJvmMemoryNonHeapUsed(MetricMonitorValues.getLong(r,JVM_MEMORY_NONHEAP_USED));
  stat.setJvmMemoryPoolsCodeCacheUsage(MetricMonitorValues.getLong(r,JVM_MEMORY_POOLS_CODECACHE));
  stat.setJvmMemoryPoolsEdenSpaceUsage(MetricMonitorValues.getLong(r,JVM_MEMORY_POOLS_EDEN));
  stat.setJvmMemoryPoolsPermGenUsage(MetricMonitorValues.getLong(r,JVM_MEMORY_POOLS_PERMGEN));
  stat.setJvmMemoryPoolsSurvivorSpaceUsage(MetricMonitorValues.getLong(r,JVM_MEMORY_POOLS_SURVIVOR));
  stat.setJvmMemoryPoolsTenuredGenUsage(MetricMonitorValues.getLong(r,JVM_MEMORY_POOLS_TENURED));
  stat.setJvmGcCopyCount(MetricMonitorValues.getLong(r,JVM_GC_SERIAL_COPY_COUNT));
  stat.setJvmGcCopyTime(MetricMonitorValues.getLong(r,JVM_GC_SERIAL_COPY_TIME));
  stat.setJvmGcMarkSweepCompactCount(MetricMonitorValues.getLong(r,JVM_GC_SERIAL_MSC_COUNT));
  stat.setJvmGcMarkSweepCompactTime(MetricMonitorValues.getLong(r,JVM_GC_SERIAL_MSC_TIME));
}
