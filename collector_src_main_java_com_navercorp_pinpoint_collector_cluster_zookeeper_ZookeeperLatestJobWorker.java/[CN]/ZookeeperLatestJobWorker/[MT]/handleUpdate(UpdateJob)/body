{
  ChannelContext channelContext=job.getChannelContext();
  PinpointServerSocketStateCode code=channelContext.getCurrentStateCode();
  if (PinpointServerSocketStateCode.isFinished(code)) {
    putJob(new DeleteJob(channelContext));
    return false;
  }
  String uniquePath=getUniquePath(channelContext,true);
  if (uniquePath == null) {
    logger.warn("Zookeeper UniqPath({}) may not be null.",uniquePath);
    return false;
  }
  try {
    if (zookeeperClient.exists(uniquePath)) {
      zookeeperClient.setData(uniquePath,job.getContents());
    }
 else {
      zookeeperClient.createPath(uniquePath);
      zookeeperClient.createNode(uniquePath,job.getContents());
      logger.info("Registed Zookeeper UniqPath = {}",uniquePath);
    }
    return true;
  }
 catch (  Exception e) {
    logger.warn(e.getMessage(),e);
    if (e instanceof TimeoutException) {
      job.incrementCurrentRetryCount();
      putJob(job);
    }
  }
  return false;
}
