{
  ChannelContext channelContext=job.getChannelContext();
  PinpointServerSocketStateCode code=channelContext.getCurrentStateCode();
  if (PinpointServerSocketStateCode.isFinished(code)) {
    putJob(new DeleteJob(channelContext));
    return false;
  }
  try {
    String addContents=createProfilerContents(channelContext);
    if (zookeeperClient.exists(collectorUniqPath)) {
      byte[] contents=zookeeperClient.getData(collectorUniqPath);
      String data=addIfAbsentContents(new String(contents,charset),addContents);
      zookeeperClient.setData(collectorUniqPath,data.getBytes(charset));
    }
 else {
      zookeeperClient.createPath(collectorUniqPath);
      zookeeperClient.createNode(collectorUniqPath,addContents.getBytes(charset));
    }
    return true;
  }
 catch (  Exception e) {
    logger.warn(e.getMessage(),e);
    if (e instanceof TimeoutException) {
      putRetryJob(job);
    }
  }
  return false;
}
