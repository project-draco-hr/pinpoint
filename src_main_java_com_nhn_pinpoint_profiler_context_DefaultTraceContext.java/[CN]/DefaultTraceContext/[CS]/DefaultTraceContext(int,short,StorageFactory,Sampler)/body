{
  if (storageFactory == null) {
    throw new NullPointerException("storageFactory must not be null");
  }
  if (sampler == null) {
    throw new NullPointerException("sampler must not be null");
  }
  this.sqlCache=new LRUCache<String>(sqlCacheSize);
  this.contextServiceType=ServiceType.findServiceType(contextServiceType);
  this.metricRegistry=new MetricRegistry(this.contextServiceType);
  this.traceFactory=new ThreadLocalTraceFactory(this,metricRegistry,storageFactory,sampler);
}
