{
  final ThreadFactory threadFactory=new PinpointThreadFactory(SCHEDULED_FLUSH,true);
  final Thread thread=threadFactory.newThread(new Runnable(){
    @Override public void run(){
      while (true) {
        try {
          chunkHeaderBufferedSerializer.flush();
        }
 catch (        TException e) {
          logger.warn("Failed to flush. caused={}",e.getMessage(),e);
        }
        try {
          TimeUnit.MILLISECONDS.sleep(1000);
        }
 catch (        InterruptedException ignored) {
        }
      }
    }
  }
);
  thread.start();
}
