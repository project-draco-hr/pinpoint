{
  KeyValue[] keyList=result.raw();
  Map<Integer,List<AnnotationBo>> annotationList=new HashMap<Integer,List<AnnotationBo>>();
  for (  KeyValue kv : keyList) {
    byte[] bytes=kv.getBuffer();
    Buffer buffer=new FixedBuffer(bytes,kv.getQualifierOffset());
    int spanId=buffer.readInt();
    if (kv.getFamilyLength() == HBaseTables.TRACES_CF_ANNOTATION.length) {
      int valueLength=kv.getValueLength();
      if (valueLength == 0) {
        continue;
      }
      buffer.setOffset(kv.getValueOffset());
      AnnotationBoList annotationBoList=new AnnotationBoList();
      annotationBoList.readValue(buffer);
      if (annotationBoList.size() > 0) {
        annotationBoList.setSpanId(spanId);
        annotationList.put(spanId,annotationBoList.getAnnotationBoList());
      }
    }
  }
  return annotationList;
}
