{
  SpanBo span=new SpanBo();
  span.setServiceType((short)1000);
  span.setExceptionInfo(1,"spanException");
  SpanEventBo firstSpanEventBo=new SpanEventBo();
  firstSpanEventBo.setExceptionInfo(2,"first");
  firstSpanEventBo.setEndElapsed(100);
  AnnotationBo annotationBo=newAnnotation(200,"annotation");
  firstSpanEventBo.setAnnotationBoList(Lists.<AnnotationBo>newArrayList(annotationBo));
  firstSpanEventBo.setServiceType((short)1003);
  firstSpanEventBo.setSequence((short)0);
  span.addSpanEvent(firstSpanEventBo);
  SpanEventBo nextSpanEventBo=new SpanEventBo();
  nextSpanEventBo.setEndElapsed(200);
  nextSpanEventBo.setServiceType((short)2003);
  nextSpanEventBo.setSequence((short)1);
  span.addSpanEvent(nextSpanEventBo);
  SpanEncodingContext<SpanBo> encodingContext=new SpanEncodingContext<>(span);
  SpanEncoder encoder=new SpanEncoder();
  ByteBuffer byteBuffer=encoder.encodeSpanColumnValue(encodingContext);
  Buffer buffer=new OffsetFixedBuffer(byteBuffer.array(),byteBuffer.arrayOffset(),byteBuffer.remaining());
  SpanBo readSpan=new SpanBo();
  SpanDecodingContext decodingContext=new SpanDecodingContext();
  decoder.readSpanValue(buffer,readSpan,new SpanEventBo(),decodingContext);
  Assert.assertEquals(readSpan.getSpanEventBoList().size(),2);
  Assert.assertEquals(readSpan.getServiceType(),1000);
  Assert.assertEquals(readSpan.hasException(),true);
  Assert.assertEquals(readSpan.getExceptionId(),1);
  Assert.assertEquals(readSpan.getExceptionMessage(),"spanException");
  List<SpanEventBo> spanEventBoList=readSpan.getSpanEventBoList();
  SpanEventBo readFirst=spanEventBoList.get(0);
  SpanEventBo readNext=spanEventBoList.get(1);
  Assert.assertEquals(readFirst.getEndElapsed(),100);
  Assert.assertEquals(readNext.getEndElapsed(),200);
  Assert.assertEquals(readFirst.getExceptionId(),2);
  Assert.assertEquals(readNext.hasException(),false);
  Assert.assertEquals(readFirst.getServiceType(),1003);
  Assert.assertEquals(readNext.getServiceType(),2003);
  Assert.assertEquals(readFirst.getSequence(),0);
  Assert.assertEquals(readNext.getSequence(),1);
}
