{
  try {
    SpanEvent spanEvent=(SpanEvent)tbase;
    if (logger.isInfoEnabled()) {
      logger.info("Received SpanEvent={}",spanEvent);
    }
    traceDao.insertEvent(spanEvent);
    ServiceType serviceType=ServiceType.findServiceType(spanEvent.getServiceType());
    if (!serviceType.isRecordStatistics()) {
      return;
    }
    int elapsed=spanEvent.getEndElapsed();
    boolean hasException=SpanEventUtils.hasException(spanEvent);
    terminalStatistics.update(spanEvent.getApplicationId(),spanEvent.getDestinationId(),serviceType.getCode(),spanEvent.getEndPoint(),elapsed,hasException);
  }
 catch (  Exception e) {
    logger.warn("SpanEvent handle error " + e.getMessage(),e);
  }
}
