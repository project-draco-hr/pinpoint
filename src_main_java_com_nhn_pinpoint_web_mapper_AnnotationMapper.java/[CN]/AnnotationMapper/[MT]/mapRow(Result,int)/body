{
  KeyValue[] keyList=result.raw();
  Map<Long,List<AnnotationBo>> annotationList=new HashMap<Long,List<AnnotationBo>>();
  for (  KeyValue kv : keyList) {
    final byte[] bytes=kv.getBuffer();
    Buffer buffer=new FixedBuffer(bytes,kv.getQualifierOffset());
    long spanId=buffer.readLong();
    if (Bytes.equals(kv.getFamily(),HBaseTables.TRACES_CF_ANNOTATION)) {
      int valueLength=kv.getValueLength();
      if (valueLength == 0) {
        continue;
      }
      buffer.setOffset(kv.getValueOffset());
      AnnotationBoList annotationBoList=new AnnotationBoList();
      annotationBoList.readValue(buffer);
      if (annotationBoList.size() > 0) {
        annotationBoList.setSpanId(spanId);
        annotationList.put(spanId,annotationBoList.getAnnotationBoList());
      }
    }
  }
  return annotationList;
}
