{
  if (logger.isInfoEnabled()) {
    logger.info("Modifing. {}",javassistClassName);
  }
  byteCodeInstrumentor.checkLibrary(classLoader,javassistClassName);
  try {
    InstrumentClass standardService=byteCodeInstrumentor.getClass(javassistClassName);
    LifeCycleEventListener lifeCycleEventListener=new LifeCycleEventListener(agent);
    if (standardService.hasDeclaredMethod("start",null) && standardService.hasDeclaredMethod("stop",null)) {
      standardService.addInterceptor("start",null,new StandardServiceStartInterceptor(lifeCycleEventListener));
      standardService.addInterceptor("stop",null,new StandardServiceStopInterceptor(lifeCycleEventListener));
    }
 else     if (standardService.hasDeclaredMethod("startInternal",null) && standardService.hasDeclaredMethod("stopInternal",null)) {
      standardService.addInterceptor("startInternal",null,new StandardServiceStartInterceptor(lifeCycleEventListener));
      standardService.addInterceptor("stopInternal",null,new StandardServiceStopInterceptor(lifeCycleEventListener));
    }
    return standardService.toBytecode();
  }
 catch (  InstrumentException e) {
    logger.warn("modify fail. Cause:" + e.getMessage(),e);
    return null;
  }
}
