{
  final Node key=new Node(calleeApplicationName,ServiceType.findServiceType(calleeServiceType));
  if (callerFoundApplications.contains(key)) {
    logger.debug("ApplicationStatistics exists. Skip finding caller. {} {}",calleeApplicationName,calleeServiceType);
    return new HashSet<TransactionFlowStatistics>(0);
  }
  callerFoundApplications.add(key);
  if (logger.isDebugEnabled()) {
    logger.debug("Finding Caller. callee={}, serviceType={}",calleeApplicationName,ServiceType.findServiceType(calleeServiceType));
  }
  final Set<TransactionFlowStatistics> callerSet=new HashSet<TransactionFlowStatistics>();
  final List<TransactionFlowStatistics> caller=applicationMapStatisticsCallerDao.selectCaller(calleeApplicationName,calleeServiceType,from,to);
  logger.debug("Found Caller. count={}, callee={}",caller.size(),calleeApplicationName);
  for (  TransactionFlowStatistics stat : caller) {
    fillAdditionalInfo(stat,from,to);
    callerSet.add(stat);
    Set<TransactionFlowStatistics> callerSub=selectCaller(stat.getFrom(),stat.getFromServiceType().getCode(),from,to,calleeFoundApplications,callerFoundApplications);
    callerSet.addAll(callerSub);
    for (    TransactionFlowStatistics eachCallee : callerSub) {
      if (eachCallee.getToServiceType().isTerminal() || eachCallee.getToServiceType().isUnknown()) {
        continue;
      }
      Set<TransactionFlowStatistics> calleeSub=selectCallee(eachCallee.getTo(),eachCallee.getToServiceType().getCode(),from,to,calleeFoundApplications,callerFoundApplications);
      callerSet.addAll(calleeSub);
    }
  }
  return callerSet;
}
