{
  if (callerFoundApplications.contains(calleeApplicationName + calleeServiceType)) {
    logger.debug("ApplicationStatistics exists. Skip finding caller. " + calleeApplicationName + calleeServiceType);
    return new HashSet<ApplicationStatistics>(0);
  }
  callerFoundApplications.add(calleeApplicationName + calleeServiceType);
  logger.debug("Find Caller. callee=" + calleeApplicationName + ", serviceType="+ ServiceType.findServiceType(calleeServiceType)+ ", hideIndirectAccess="+ hideIndirectAccess);
  final Set<ApplicationStatistics> callerSet=new HashSet<ApplicationStatistics>();
  Map<String,ApplicationStatistics> caller=applicationMapStatisticsCallerDao.selectCaller(calleeApplicationName,calleeServiceType,from,to);
  logger.debug("     Found Caller. count=" + caller.size() + ", callee="+ calleeApplicationName);
  for (  Entry<String,ApplicationStatistics> entry : caller.entrySet()) {
    fillAdditionalInfo(entry.getValue(),from,to);
    callerSet.add(entry.getValue());
    ApplicationStatistics stat=entry.getValue();
    Set<ApplicationStatistics> callerSub=selectCaller(stat.getFrom(),stat.getFromServiceType().getCode(),from,to,calleeFoundApplications,callerFoundApplications,hideIndirectAccess);
    callerSet.addAll(callerSub);
    if (!hideIndirectAccess) {
      for (      ApplicationStatistics eachCallee : callerSub) {
        if (eachCallee.getToServiceType().isTerminal() || eachCallee.getToServiceType().isUnknown()) {
          continue;
        }
        Set<ApplicationStatistics> calleeSub=selectCallee(eachCallee.getTo(),eachCallee.getToServiceType().getCode(),from,to,calleeFoundApplications,callerFoundApplications,hideIndirectAccess);
        callerSet.addAll(calleeSub);
      }
    }
  }
  return callerSet;
}
