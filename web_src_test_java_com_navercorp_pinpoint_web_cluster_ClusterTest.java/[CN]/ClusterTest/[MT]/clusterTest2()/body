{
  ts.restart();
  Thread.sleep(5000);
  ZooKeeper zookeeper=new ZooKeeper(zookeeperAddress,5000,null);
  getNodeAndCompareContents(zookeeper);
  ts.stop();
  Thread.sleep(5000);
  try {
    zookeeper.getData(CLUSTER_NODE_PATH,null,null);
    Assert.fail();
  }
 catch (  KeeperException e) {
    Assert.assertEquals(KeeperException.Code.CONNECTIONLOSS,e.code());
    e.printStackTrace();
  }
  ts.restart();
  getNodeAndCompareContents(zookeeper);
  if (zookeeper != null) {
    zookeeper.close();
  }
}
