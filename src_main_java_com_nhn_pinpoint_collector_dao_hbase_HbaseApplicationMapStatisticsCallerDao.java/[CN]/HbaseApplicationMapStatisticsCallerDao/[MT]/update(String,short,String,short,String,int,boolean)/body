{
  if (calleeApplicationName == null) {
    throw new IllegalArgumentException("calleeApplicationName is null.");
  }
  if (callerApplicationName == null) {
    throw new IllegalArgumentException("callerApplicationName is null.");
  }
  if (logger.isDebugEnabled()) {
    logger.debug("[UpdatingApplicationMapStatisticsCaller] " + callerApplicationName + " ("+ ServiceType.findServiceType(callerServiceType)+ ")["+ callerHost+ "] -> "+ calleeApplicationName+ " ("+ ServiceType.findServiceType(calleeServiceType)+ ")");
  }
  if (callerHost == null) {
    callerHost="";
  }
  long acceptedTime=acceptedTimeService.getAcceptedTime();
  long rowTimeSlot=TimeSlot.getStatisticsRowSlot(acceptedTime);
  if (useBulk) {
    CallerKey callerKey=new CallerKey(callerApplicationName,callerServiceType,rowTimeSlot,calleeServiceType,calleeApplicationName,callerHost,elapsed,isError);
    counter.increment(callerKey,1L);
  }
 else {
    final byte[] rowKey=ApplicationMapStatisticsUtils.makeRowKey(callerApplicationName,callerServiceType,rowTimeSlot);
    byte[] columnName=ApplicationMapStatisticsUtils.makeColumnName(calleeServiceType,calleeApplicationName,callerHost,elapsed,isError);
    increment(rowKey,columnName,1L);
  }
}
