{
  if (!useBulk) {
    throw new IllegalStateException();
  }
  Map<RowInfo,ConcurrentCounterMap.LongAdder> remove=this.counter.remove();
  List<Increment> merge=rowKeyMerge.createBulkIncrement(remove);
  if (merge.size() != 0) {
    logger.debug("flush {} Increment:{}",this.getClass().getSimpleName(),merge.size());
  }
  for (  Increment increment : merge) {
    hbaseTemplate.increment(APPLICATION_MAP_STATISTICS_CALLER,increment);
  }
}
