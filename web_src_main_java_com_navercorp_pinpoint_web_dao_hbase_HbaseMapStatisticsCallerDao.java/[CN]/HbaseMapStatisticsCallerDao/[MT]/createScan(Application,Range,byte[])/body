{
  range=rangeFactory.createStatisticsRange(range);
  if (logger.isDebugEnabled()) {
    logger.debug("scan Time:{}",range.prettyToString());
  }
  byte[] startKey=ApplicationMapStatisticsUtils.makeRowKey(application.getName(),application.getServiceTypeCode(),range.getTo());
  byte[] endKey=ApplicationMapStatisticsUtils.makeRowKey(application.getName(),application.getServiceTypeCode(),range.getFrom());
  Scan scan=new Scan();
  scan.setCaching(this.scanCacheSize);
  scan.setStartRow(startKey);
  scan.setStopRow(endKey);
  for (  byte[] family : familyArgs) {
    scan.addFamily(family);
  }
  scan.setId("ApplicationStatisticsScan");
  return scan;
}
