{
  int chunkCount=2;
  int availableBufferSize=spanStreamSendData.getMaxBufferCapacity();
  for (int i=0; i < compositeSpanStreamData.getComponentsCount(); i++) {
    int currentComponentBufferLength=compositeSpanStreamData.getComponentBufferLength(i);
    if (compositeSpanStreamData.isLastComponentIndex(i)) {
      if (currentComponentBufferLength > availableBufferSize) {
        chunkCount++;
      }
    }
 else {
      if (currentComponentBufferLength + getSpanChunkLength() < availableBufferSize) {
        availableBufferSize-=currentComponentBufferLength;
      }
 else {
        chunkCount++;
        availableBufferSize=spanStreamSendData.getMaxBufferCapacity();
        availableBufferSize-=currentComponentBufferLength;
      }
    }
  }
  return chunkCount;
}
