{
  if (agentId == null) {
    throw new NullPointerException("agentId must not be null");
  }
  Scan scan=createScan(agentId,currentTime);
  AgentInfoBo agentInfoBo=hbaseOperations2.find(HBaseTables.AGENTINFO,scan,new ResultsExtractor<AgentInfoBo>(){
    @Override public AgentInfoBo extractData(    ResultScanner results) throws Exception {
      for (Result next; (next=results.next()) != null; ) {
        byte[] row=next.getRow();
        long reverseStartTime=BytesUtils.bytesToLong(row,HBaseTables.AGENT_NAME_MAX_LEN);
        long startTime=TimeUtils.recoveryCurrentTimeMillis(reverseStartTime);
        logger.debug("agent:{} startTime value {}",agentId,startTime);
        if (startTime < currentTime) {
          byte[] value=next.getValue(HBaseTables.AGENTINFO_CF_INFO,HBaseTables.AGENTINFO_CF_INFO_IDENTIFIER);
          AgentInfoBo agentInfoBo=new AgentInfoBo();
          agentInfoBo.setAgentId(agentId);
          agentInfoBo.setStartTime(startTime);
          agentInfoBo.readValue(value);
          logger.debug("agent:{} startTime find {}",agentId,startTime);
          return agentInfoBo;
        }
      }
      logger.warn("agentInfo not found. agentId={}, time={}",agentId,currentTime);
      return null;
    }
  }
);
  return agentInfoBo;
}
