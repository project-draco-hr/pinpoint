{
  final Buffer buffer=new AutomaticBuffer(512);
  buffer.putByte(version);
  buffer.putPrefixedString(agentId);
  buffer.putPrefixedString(applicationId);
  buffer.putVLong(agentStartTime);
  buffer.putVInt(startElapsed);
  buffer.putVInt(endElapsed);
  buffer.putPrefixedString(rpc);
  buffer.putShort(serviceType);
  buffer.putPrefixedString(endPoint);
  buffer.putPrefixedString(destinationId);
  buffer.putSVInt(apiId);
  buffer.putSVInt(depth);
  buffer.putLong(nextSpanId);
  if (hasException) {
    buffer.putBoolean(true);
    buffer.putSVInt(exceptionId);
    buffer.putPrefixedString(exceptionMessage);
  }
 else {
    buffer.putBoolean(false);
  }
  writeAnnotation(buffer);
  buffer.putSVInt(nextAsyncId);
  return buffer.getBuffer();
}
