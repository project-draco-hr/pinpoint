{
  if (agentSet == null) {
    return;
  }
  for (  AgentInfoBo agent : agentSet) {
    String key=agent.getHostname();
    SortedMap<String,ServerInstance> serverInstanceMap=serverInstanceList.get(key);
    ResponseHistogram histogram=null;
    if (agentHistogram != null) {
      Host host=agentHistogram.get(agent.getAgentId());
      if (host != null) {
        histogram=host.getHistogram();
      }
    }
    ServerInstance serverInstance=new ServerInstance(agent,histogram);
    if (serverInstanceMap == null) {
      SortedMap<String,ServerInstance> value=new TreeMap<String,ServerInstance>();
      value.put(serverInstance.getId(),serverInstance);
      serverInstanceList.put(key,value);
    }
 else {
      SortedMap<String,ServerInstance> map=serverInstanceList.get(key);
      if (map.containsKey(serverInstance.getId())) {
        map.get(serverInstance.getId()).mergeWith(serverInstance);
      }
 else {
        map.put(key,serverInstance);
      }
    }
  }
}
