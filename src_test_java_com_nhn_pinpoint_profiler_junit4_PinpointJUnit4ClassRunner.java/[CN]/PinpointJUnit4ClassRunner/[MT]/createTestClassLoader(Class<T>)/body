{
  System.setProperty("catalina.home","test");
  PLoggerFactory.initialize(new Slf4jLoggerBinder());
  ProfilerConfig profilerConfig=new ProfilerConfig();
  String path=ProfilerConfig.class.getClassLoader().getResource("pinpoint.config").getPath();
  try {
    profilerConfig.readConfigFile(path);
  }
 catch (  IOException e) {
    throw new InitializationError("Unable to read pinpoint.config");
  }
  profilerConfig.setApplicationServerType(ServiceType.STAND_ALONE);
  DefaultAgent agent=new MockAgent("",new DummyInstrumentation(),profilerConfig);
  try {
    Constructor<T> c=testClassLoader.getConstructor(DefaultAgent.class);
    T classLoader=c.newInstance(agent);
    return classLoader;
  }
 catch (  Exception e) {
    throw new InitializationError("Error instantiating Test");
  }
}
