{
  ProfilerCommandServiceRegistry registry=new ProfilerCommandServiceRegistry();
  for (  ProfilerCommandService service : builder.serviceList) {
    registry.addService(service);
  }
  this.locator=registry;
  SerializerFactory<HeaderTBaseSerializer> serializerFactory=new HeaderTBaseSerializerFactory(true,builder.serializationMaxSize,builder.protocolFactory,builder.commandTbaseLocator);
  this.serializerFactory=wrappedThreadLocalSerializerFactory(serializerFactory);
  AssertUtils.assertNotNull(this.serializerFactory);
  DeserializerFactory<HeaderTBaseDeserializer> deserializerFactory=new HeaderTBaseDeserializerFactory(builder.protocolFactory,builder.commandTbaseLocator);
  this.deserializerFactory=wrappedThreadLocalDeserializerFactory(deserializerFactory);
  AssertUtils.assertNotNull(this.deserializerFactory);
}
