{
  if (!limit) {
synchronized (this) {
      addSpanEvent(spanEvent);
    }
    limit=checkLimit(spanEvent);
  }
 else {
    List<SpanEvent> flushData=null;
    boolean add;
synchronized (this) {
      addSpanEvent(spanEvent);
      if (storage.size() >= bufferSize) {
        flushData=storage;
        storage=new ArrayList<SpanEvent>(bufferSize + RESERVE_BUFFER_SIZE);
      }
    }
    if (flushData != null) {
      final SpanChunk spanChunk=spanChunkFactory.create(flushData);
      dataSender.send(spanChunk);
    }
  }
}
