{
  if (includeServiceType(fromServiceCode,ServiceType.USER)) {
    for (    SpanBo span : transaction) {
      if (span.isRoot() && includeServiceType(toServiceCode,getServiceType(span.getServiceType())) && toApplicationName.equals(span.getApplicationId())) {
        return true;
      }
    }
  }
 else   if (includeUnknown(toServiceCode)) {
    for (    SpanBo span : transaction) {
      if (includeServiceType(fromServiceCode,getServiceType(span.getServiceType())) && fromApplicationName.equals(span.getApplicationId())) {
        List<SpanEventBo> eventBoList=span.getSpanEventBoList();
        if (eventBoList == null) {
          continue;
        }
        for (        SpanEventBo event : eventBoList) {
          if (getServiceType(event.getServiceType()).isRpcClient() && toApplicationName.equals(event.getDestinationId())) {
            return true;
          }
        }
      }
    }
  }
 else   if (includeWas(toServiceCode)) {
    for (    SpanBo srcSpan : transaction) {
      if (includeServiceType(fromServiceCode,getServiceType(srcSpan.getServiceType())) && fromApplicationName.equals(srcSpan.getApplicationId())) {
        for (        SpanBo destSpan : transaction) {
          if (destSpan.getParentSpanId() != srcSpan.getSpanId()) {
            continue;
          }
          if (includeServiceType(toServiceCode,getServiceType(destSpan.getServiceType())) && toApplicationName.equals(destSpan.getApplicationId())) {
            return true;
          }
        }
      }
    }
  }
 else {
    for (    SpanBo span : transaction) {
      if (includeServiceType(fromServiceCode,getServiceType(span.getServiceType())) && fromApplicationName.equals(span.getApplicationId())) {
        List<SpanEventBo> eventBoList=span.getSpanEventBoList();
        if (eventBoList == null) {
          continue;
        }
        for (        SpanEventBo event : eventBoList) {
          if (includeServiceType(toServiceCode,getServiceType(event.getServiceType())) && toApplicationName.equals(event.getDestinationId())) {
            return true;
          }
        }
      }
    }
  }
  return false;
}
