{
  try {
    byte[] startRow=query.getStartRow();
    byte[] stopRow=query.getStopRow();
    String tableName=query.getTableName();
    System.out.println("startRow=" + startRow);
    System.out.println("stopRow=" + stopRow);
    System.out.println("tableName=" + tableName);
    columns=query.getColumns();
    HTableInterface htable=getHTable(tableName);
    if (query.isSingleRow()) {
      Get get=new Get(startRow);
      if (columns != null) {
        for (        HbaseColumn column : columns) {
          get.addColumn(column.getFamily().getBytes(),column.getColumnName().getBytes());
        }
      }
      Result result=htable.get(get);
      List<Result> resultList=new ArrayList<Result>(1);
      resultList.add(result);
      resultIterator=resultList.iterator();
    }
 else {
      Scan scan=new Scan();
      if (startRow != null) {
        scan.setStartRow(startRow);
      }
      if (stopRow != null) {
        scan.setStopRow(stopRow);
      }
      if (columns != null) {
        for (        HbaseColumn column : columns) {
          scan.addColumn(column.getFamily().getBytes(),column.getColumnName().getBytes());
          System.out.println("add column to scanner " + column);
        }
      }
      LOG.debug("Executing scanner: " + query);
      long start=System.currentTimeMillis();
      resultScanner=htable.getScanner(scan);
      LOG.trace("Time taken for scanner: " + (System.currentTimeMillis() - start));
      resultIterator=resultScanner.iterator();
    }
  }
 catch (  Exception e) {
    throw new RuntimeException("UNable to execute SCANNER : " + query,e);
  }
  if (!resultIterator.hasNext()) {
    rSetIterator=new ArrayList<Map<String,Object>>().iterator();
    return;
  }
  rSetIterator=new Iterator<Map<String,Object>>(){
    public boolean hasNext(){
      return hasnext();
    }
    public Map<String,Object> next(){
      return getARow();
    }
    public void remove(){
    }
  }
;
}
