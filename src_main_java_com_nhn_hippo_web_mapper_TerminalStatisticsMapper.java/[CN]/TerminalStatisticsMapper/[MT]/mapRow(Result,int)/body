{
  KeyValue[] keyList=result.raw();
  Map<String,TerminalStatistics> stat=new HashMap<String,TerminalStatistics>();
  for (  KeyValue kv : keyList) {
    if (kv.getFamilyLength() != HBaseTables.TERMINAL_STATISTICS_CF_COUNTER.length && kv.getFamilyLength() != HBaseTables.TERMINAL_STATISTICS_CF_ERROR_COUNTER.length) {
      continue;
    }
    byte[] qualifier=kv.getQualifier();
    String from=TerminalSpanUtils.getApplicationNameFromRowKey(kv.getRow());
    String to=TerminalSpanUtils.getDestApplicationNameFromColumnName(qualifier);
    long requestCount=Bytes.toLong(kv.getValue());
    short toServiceType=TerminalSpanUtils.getDestServiceTypeFromColumnName(qualifier);
    short histogramSlot=TerminalSpanUtils.getHistogramSlotFromColumnName(qualifier);
    boolean isError=kv.getFamilyLength() == HBaseTables.TERMINAL_STATISTICS_CF_ERROR_COUNTER.length;
    if (stat.containsKey(to)) {
      TerminalStatistics statistics=stat.get(to);
      if (isError) {
        statistics.getHistogram().incrErrorCount(requestCount);
      }
 else {
        statistics.getHistogram().addSample(histogramSlot,requestCount);
      }
    }
 else {
      TerminalStatistics statistics=new TerminalStatistics(from,to,toServiceType);
      if (isError) {
        statistics.getHistogram().incrErrorCount(requestCount);
      }
 else {
        statistics.getHistogram().addSample(histogramSlot,requestCount);
      }
      stat.put(to,statistics);
    }
  }
  return stat;
}
