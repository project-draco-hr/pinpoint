{
  final byte[] rowKey=getDistributeRowKey(SpanUtils.getTransactionId(spanChunk));
  final long acceptedTime=acceptedTimeService.getAcceptedTime();
  final Put put=new Put(rowKey,acceptedTime);
  final List<TSpanEvent> spanEventBoList=spanChunk.getSpanEventList();
  if (CollectionUtils.isEmpty(spanEventBoList)) {
    return;
  }
  for (  TSpanEvent spanEvent : spanEventBoList) {
    final SpanEventBo spanEventBo=new SpanEventBo(spanChunk,spanEvent);
    addColumn(put,spanEventBo);
  }
  if (!put.isEmpty()) {
    boolean success=hbaseTemplate.asyncPut(TRACES,put);
    if (!success) {
      hbaseTemplate.put(TRACES,put);
    }
  }
}
