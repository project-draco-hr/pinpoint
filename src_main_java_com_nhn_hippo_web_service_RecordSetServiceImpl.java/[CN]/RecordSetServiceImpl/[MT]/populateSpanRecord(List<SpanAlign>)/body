{
  List<Record> recordList=new ArrayList<Record>(spanAlignList.size() * 2);
  for (  SpanAlign spanAlign : spanAlignList) {
    if (spanAlign.isSpan()) {
      SpanBo spanBo=spanAlign.getSpanBo();
      String method=(String)AnnotationUtils.getDisplayMethod(spanBo);
      String argument=getRpcArgument(spanBo);
      long begin=spanBo.getStartTime();
      long elapsed=spanBo.getElapsed();
      ApiDescription apiDescription=apiDescriptionParser.parse(method);
      Record record=new Record(spanAlign.getDepth(),true,apiDescription.getSimpleMethodDescription(),argument,begin,elapsed,spanBo.getAgentId(),spanBo.getApplicationId(),spanBo.getServiceType(),null);
      record.setSimpleClassName(apiDescription.getSimpleClassName());
      record.setFullApiDescription(method);
      recordList.add(record);
      List<Record> annotationRecord=createAnnotationRecord(spanAlign.getDepth() + 1,spanBo.getAnnotationBoList());
      recordList.addAll(annotationRecord);
      if (spanBo.getRemoteAddr() != null) {
        Record remoteAddress=createParameterRecord(spanAlign.getDepth() + 1,"REMOTE_ADDRESS",spanBo.getRemoteAddr());
        recordList.add(remoteAddress);
      }
    }
 else {
      SpanEventBo spanEventBo=spanAlign.getSpanEventBo();
      String method=(String)AnnotationUtils.getDisplayMethod(spanEventBo);
      String argument=getDisplayArgument(spanEventBo);
      long begin=spanAlign.getSpanBo().getStartTime() + spanEventBo.getStartElapsed();
      long elapsed=spanEventBo.getEndElapsed();
      ApiDescription apiDescription=apiDescriptionParser.parse(method);
      String destinationId=spanEventBo.getDestinationId();
      Record record=new Record(spanAlign.getDepth(),true,apiDescription.getSimpleMethodDescription(),argument,begin,elapsed,spanEventBo.getAgentId(),spanEventBo.getDestinationId(),spanEventBo.getServiceType(),destinationId);
      record.setSimpleClassName(apiDescription.getSimpleClassName());
      record.setFullApiDescription(method);
      recordList.add(record);
      List<Record> annotationRecord=createAnnotationRecord(spanAlign.getDepth() + 1,spanEventBo.getAnnotationBoList());
      recordList.addAll(annotationRecord);
    }
  }
  return recordList;
}
