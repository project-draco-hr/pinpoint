{
  StopWatch watch=new StopWatch();
  watch.start();
  List<List<SpanBo>> transactionList=this.traceDao.selectAllSpans(traceIdSet);
  List<SpanBo> transaction=new ArrayList<SpanBo>();
  for (  List<SpanBo> t : transactionList) {
    for (    SpanBo span : t) {
      if (filter.include(span)) {
        transaction.add(span);
      }
    }
  }
  Set<String> endPoints=createUniqueEndpoint(transaction);
  ServerCallTree tree=createServerCallTree(transaction,new ApplicationIdNodeSelector());
  List<SpanEventBo> spanEventBoList=findRecordStatisticsSpanEventData(transaction,endPoints);
  tree.addSpanEventList(spanEventBoList);
  tree.build();
  watch.stop();
  logger.info("Fetch single transaction serverCallTree elapsed. {}ms",watch.getLastTaskTimeMillis());
  return tree;
}
