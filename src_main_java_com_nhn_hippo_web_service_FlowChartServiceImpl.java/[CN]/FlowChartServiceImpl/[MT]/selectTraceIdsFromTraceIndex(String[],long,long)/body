{
  if (agentIds == null) {
    throw new NullPointerException("agentIds");
  }
  if (agentIds.length == 1) {
    if (logger.isTraceEnabled()) {
      logger.trace("scan {}, {}, {}",new Object[]{agentIds[0],from,to});
    }
    List<byte[]> bytes=this.rootTraceIndexDao.scanTraceIndex(agentIds[0],from,to);
    Set<TraceId> result=new HashSet<TraceId>();
    for (    byte[] traceId : bytes) {
      TraceId tid=new TraceId(traceId);
      result.add(tid);
      logger.trace("traceid:{}",tid);
    }
    return result;
  }
 else {
    List<List<byte[]>> multiScan=this.rootTraceIndexDao.multiScanTraceIndex(agentIds,from,to);
    Set<TraceId> result=new HashSet<TraceId>();
    for (    List<byte[]> scan : multiScan) {
      for (      byte[] traceId : scan) {
        result.add(new TraceId(traceId));
      }
    }
    return result;
  }
}
