{
  if (agentIds == null) {
    throw new NullPointerException("agentIds");
  }
  if (agentIds.length == 1) {
    if (logger.isTraceEnabled()) {
      logger.trace("scan {}, {}, {}",new Object[]{agentIds[0],from,to});
    }
    List<List<byte[]>> bytes=this.traceIndexDao.scanTraceIndex(agentIds[0],from,to);
    Set<TraceId> result=new HashSet<TraceId>();
    for (    List<byte[]> list : bytes) {
      for (      byte[] traceId : list) {
        TraceId tid=new TraceId(traceId);
        result.add(tid);
        logger.trace("traceid:{}",tid);
      }
    }
    return result;
  }
 else {
    List<List<List<byte[]>>> multiScan=this.traceIndexDao.multiScanTraceIndex(agentIds,from,to);
    Set<TraceId> result=new HashSet<TraceId>();
    for (    List<List<byte[]>> list : multiScan) {
      for (      List<byte[]> scan : list) {
        for (        byte[] traceId : scan) {
          result.add(new TraceId(traceId));
        }
      }
    }
    return result;
  }
}
