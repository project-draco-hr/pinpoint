{
  if (agentIds == null) {
    throw new NullPointerException("agentIds");
  }
  if (agentIds.length == 1) {
    if (logger.isTraceEnabled()) {
      logger.trace("scan {}, {}, {}",new Object[]{agentIds[0],from,to});
    }
    List<List<TraceId>> bytes=this.traceIndexDao.scanTraceIndex(agentIds[0],from,to);
    Set<TraceId> result=new HashSet<TraceId>();
    for (    List<TraceId> list : bytes) {
      for (      TraceId traceId : list) {
        result.add(traceId);
        logger.trace("traceid:{}",traceId);
      }
    }
    return result;
  }
 else {
    List<List<List<TraceId>>> multiScan=this.traceIndexDao.multiScanTraceIndex(agentIds,from,to);
    Set<TraceId> result=new HashSet<TraceId>();
    for (    List<List<TraceId>> list : multiScan) {
      for (      List<TraceId> scan : list) {
        for (        TraceId traceId : scan) {
          result.add(traceId);
        }
      }
    }
    return result;
  }
}
