{
  try {
    InputStream sourceStream=new ClassPathResource(fileSource,getClass()).getInputStream();
    IDataSet dataset=null;
    if (type == DataType.EXCEL) {
      dataset=new XlsDataSet(sourceStream);
    }
 else     if (type == DataType.FLATXML) {
      dataset=new FlatXmlDataSet(sourceStream);
    }
    operation.execute(new DatabaseConnection(DataSourceUtils.getConnection(dataSource)),dataset);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
