{
  final Span span=this.getCallStack().getSpan();
  final boolean isError=span.getErrCode() != 0;
  final int elapsedTime=this.currentStackFrame.getElapsedTime();
  final TraceContext traceContext=this.traceContext;
  if (isError) {
    traceContext.recordContextMetricIsError();
  }
 else {
    traceContext.recordContextMetric(elapsedTime);
  }
  final String parentApplicationName=span.getParentApplicationName();
  if (parentApplicationName == null) {
    if (isError) {
      traceContext.recordUserAcceptResponseTime(HistogramSchema.ERROR_SLOT_TIME);
    }
 else {
      traceContext.recordUserAcceptResponseTime(elapsedTime);
    }
  }
 else {
    final short parentApplicationType=span.getParentApplicationType();
    if (isError) {
      traceContext.recordAcceptResponseTime(parentApplicationName,parentApplicationType,HistogramSchema.ERROR_SLOT_TIME);
    }
 else {
      traceContext.recordAcceptResponseTime(parentApplicationName,parentApplicationType,elapsedTime);
    }
  }
}
