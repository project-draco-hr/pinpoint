{
  if (agentId == null) {
    throw new NullPointerException("agentId must not be null");
  }
  if (logger.isDebugEnabled()) {
    logger.debug("scanAgentStat : agentId={}, start={}, end={}",agentId,start,end);
  }
  if (end < start) {
    logger.error("invalid parameter : agentId={}, start={}, end={}",agentId,start,end);
    return Collections.emptyList();
  }
  Scan scan=createScan(agentId,start,end);
  List<List<TAgentStat>> intermediate=hbaseOperations2.find(HBaseTables.AGENT_STAT,scan,rowKeyDistributor,agentStatMapper);
  int expectedSize=(int)((end - start) / 5000);
  List<TAgentStat> merged=new ArrayList<TAgentStat>(expectedSize);
  for (  List<TAgentStat> each : intermediate) {
    merged.addAll(each);
  }
  return merged;
}
