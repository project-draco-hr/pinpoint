{
  NpcConnectionFactory factory=new NpcConnectionFactory();
  factory.setBoxDirectoryServiceHostName(mailResource.getUrl());
  factory.setCharset(Charset.forName("UTF-8"));
  factory.setLightWeight(true);
  NpcHessianConnector connector=null;
  try {
    connector=factory.create();
    AlarmMailTemplate mailTemplate=new AlarmMailTemplate(application,mailResource,event);
    Object[] params=createSendMailParams(alarmCheckFilterList,mailTemplate);
    InvocationFuture future=connector.invoke(null,"send",params);
    future.await();
    Reply reply=(Reply)future.getReturnValue();
    if (reply instanceof ReturnValue) {
      Object result=((ReturnValue)reply).get();
      logger.debug("MessageId:{}",result);
      return true;
    }
 else     if (reply instanceof Fault) {
      String code=((Fault)reply).getCode();
      String message=((Fault)reply).getMessage();
      logger.warn("Unexpected result:code={}, message={}",code,message);
    }
 else {
      logger.warn("Unexpected clazz({}).",reply.getClass());
    }
  }
 catch (  Exception e) {
    logger.warn(e.getMessage(),e);
  }
 finally {
    if (connector != null) {
      connector.dispose();
    }
  }
  return false;
}
