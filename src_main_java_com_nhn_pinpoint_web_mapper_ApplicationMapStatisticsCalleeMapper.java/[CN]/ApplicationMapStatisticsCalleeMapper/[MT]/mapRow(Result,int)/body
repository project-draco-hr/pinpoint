{
  if (result.isEmpty()) {
    return Collections.emptyMap();
  }
  KeyValue[] keyList=result.raw();
  Map<String,TransactionFlowStatistics> stat=new HashMap<String,TransactionFlowStatistics>();
  for (  KeyValue kv : keyList) {
    final byte[] row=kv.getRow();
    String callerApplicationName=ApplicationMapStatisticsUtils.getApplicationNameFromRowKey(row);
    short callerServiceType=ApplicationMapStatisticsUtils.getApplicationTypeFromRowKey(row);
    final byte[] qualifier=kv.getQualifier();
    String calleeApplicationName=ApplicationMapStatisticsUtils.getDestApplicationNameFromColumnName(qualifier);
    short calleeServiceType=ApplicationMapStatisticsUtils.getDestServiceTypeFromColumnName(qualifier);
    long requestCount=Bytes.toLong(kv.getValue());
    short histogramSlot=ApplicationMapStatisticsUtils.getHistogramSlotFromColumnName(qualifier);
    String calleeHost=ApplicationMapStatisticsUtils.getHost(qualifier);
    boolean isError=histogramSlot == (short)-1;
    if (logger.isDebugEnabled()) {
      logger.debug("    Fetched. {}[{}] -> {}[{}] ({})",callerApplicationName,ServiceType.findServiceType(callerServiceType),calleeApplicationName,ServiceType.findServiceType(calleeServiceType),requestCount);
    }
    final String id=callerApplicationName + callerServiceType + calleeApplicationName+ calleeServiceType;
    if (stat.containsKey(id)) {
      TransactionFlowStatistics statistics=stat.get(id);
      statistics.addSample(calleeHost,calleeServiceType,(isError) ? (short)-1 : histogramSlot,requestCount);
    }
 else {
      TransactionFlowStatistics statistics=new TransactionFlowStatistics(callerApplicationName,callerServiceType,calleeApplicationName,calleeServiceType);
      statistics.addSample(calleeHost,calleeServiceType,(isError) ? (short)-1 : histogramSlot,requestCount);
      stat.put(id,statistics);
    }
  }
  return stat;
}
