{
  SpanChunkBo spanChunkBo=buildSpanChunkBo(spanChunk);
  final byte[] rowKey=getDistributeRowKey(SpanUtils.getTransactionId(spanChunk));
  final long acceptedTime=acceptedTimeService.getAcceptedTime();
  final Put put=new Put(rowKey,acceptedTime);
  final List<TSpanEvent> spanEventBoList=spanChunk.getSpanEventList();
  if (CollectionUtils.isEmpty(spanEventBoList)) {
    return;
  }
  this.spanChunkSerializer.serialize(spanChunkBo,put,null);
  if (!put.isEmpty()) {
    boolean success=hbaseTemplate.asyncPut(TRACE_V2,put);
    if (!success) {
      hbaseTemplate.put(TRACE_V2,put);
    }
  }
}
