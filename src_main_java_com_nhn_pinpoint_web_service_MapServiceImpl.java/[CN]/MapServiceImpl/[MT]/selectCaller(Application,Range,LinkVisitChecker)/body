{
  if (linkVisitChecker.visitCaller(callerApplication)) {
    return new LinkStatisticsDataSet();
  }
  LinkStatisticsData caller=mapStatisticsCallerDao.selectCaller(callerApplication,range);
  if (logger.isDebugEnabled()) {
    logger.debug("Found Caller. count={}, caller={}",caller.size(),callerApplication);
  }
  final LinkStatisticsDataSet resultCaller=new LinkStatisticsDataSet();
  for (  LinkStatistics link : caller.getLinkStatData()) {
    final AcceptedLinkStatistics isAccepted=getRpcCallAccepted(link,range);
    link=isAccepted.getLinkStatistics();
    if (!isAccepted.isAccepted()) {
      fillAdditionalInfo(link,range);
    }
    resultCaller.addSourceLinkStatistics(link);
    final Application toApplication=link.getToApplication();
    if (toApplication.getServiceType().isTerminal() || toApplication.getServiceType().isUnknown()) {
      continue;
    }
    logger.debug("     Find subCaller of {}",toApplication);
    LinkStatisticsDataSet callerSub=selectCaller(toApplication,range,linkVisitChecker);
    logger.debug("     Found subCaller. count={}, caller={}",callerSub.size(),toApplication);
    resultCaller.addLinkStatisticsDataSet(callerSub);
    for (    LinkStatistics eachCaller : callerSub.getSourceLinkStatData()) {
      logger.debug("     Find callee of {}",eachCaller.getFromApplication());
      LinkStatisticsDataSet calleeSub=selectCallee(eachCaller.getFromApplication(),range,linkVisitChecker);
      logger.debug("     Found subCallee. count={}, callee={}",calleeSub.size(),eachCaller.getFromApplication());
      resultCaller.addLinkStatisticsDataSet(calleeSub);
    }
  }
  return resultCaller;
}
