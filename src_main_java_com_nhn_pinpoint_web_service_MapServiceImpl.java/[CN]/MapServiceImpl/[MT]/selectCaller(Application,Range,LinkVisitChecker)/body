{
  if (linkVisitChecker.visitCaller(callerApplication)) {
    return new LinkStatisticsData();
  }
  LinkStatisticsData caller=mapStatisticsCallerDao.selectCaller(callerApplication,range);
  if (logger.isDebugEnabled()) {
    logger.debug("Found Caller. count={}, caller={}",caller.size(),callerApplication);
  }
  final LinkStatisticsData resultCaller=new LinkStatisticsData();
  for (  LinkStatistics stat : caller.getLinkStatData()) {
    final boolean replaced=replaceApplicationInfo(stat,range);
    if (!replaced) {
      fillAdditionalInfo(stat,range);
      resultCaller.addLinkStatistics(stat);
    }
    final Application toApplication=stat.getToApplication();
    if (toApplication.getServiceType().isTerminal() || toApplication.getServiceType().isUnknown()) {
      continue;
    }
    logger.debug("     Find subCaller of {}",toApplication);
    LinkStatisticsData callerSub=selectCaller(toApplication,range,linkVisitChecker);
    logger.debug("     Found subCaller. count={}, caller={}",callerSub.size(),toApplication);
    resultCaller.addLinkStatisticsData(callerSub);
    for (    LinkStatistics eachCaller : callerSub.getLinkStatData()) {
      logger.debug("     Find callee of {}",eachCaller.getFromApplication());
      LinkStatisticsData calleeSub=selectCallee(eachCaller.getFromApplication(),range,linkVisitChecker);
      logger.debug("     Found subCallee. count={}, callee={}",calleeSub.size(),eachCaller.getFromApplication());
      resultCaller.addLinkStatisticsData(calleeSub);
    }
  }
  return resultCaller;
}
