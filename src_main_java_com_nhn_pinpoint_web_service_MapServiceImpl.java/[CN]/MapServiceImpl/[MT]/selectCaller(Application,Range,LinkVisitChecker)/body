{
  if (linkVisitChecker.visitCaller(callerApplication)) {
    return new LinkDataDuplexMap();
  }
  LinkDataMap caller=mapStatisticsCallerDao.selectCaller(callerApplication,range);
  if (logger.isDebugEnabled()) {
    logger.debug("Found Caller. count={}, caller={}",caller.size(),callerApplication);
  }
  final LinkDataDuplexMap resultCaller=new LinkDataDuplexMap();
  for (  LinkData link : caller.getLinkDataList()) {
    link=checkRpcCallAccepted(link,range);
    resultCaller.addSourceLinkData(link);
    final Application toApplication=link.getToApplication();
    if (toApplication.getServiceType().isTerminal() || toApplication.getServiceType().isUnknown()) {
      continue;
    }
    logger.debug("     Find subCaller of {}",toApplication);
    LinkDataDuplexMap callerSub=selectCaller(toApplication,range,linkVisitChecker);
    logger.debug("     Found subCaller. count={}, caller={}",callerSub.size(),toApplication);
    resultCaller.addLinkStatisticsDataSet(callerSub);
    for (    LinkData eachCaller : callerSub.getSourceLinkDataList()) {
      logger.debug("     Find callee of {}",eachCaller.getFromApplication());
      LinkDataDuplexMap calleeSub=selectCallee(eachCaller.getFromApplication(),range,linkVisitChecker);
      logger.debug("     Found subCallee. count={}, callee={}",calleeSub.size(),eachCaller.getFromApplication());
      resultCaller.addLinkStatisticsDataSet(calleeSub);
    }
  }
  return resultCaller;
}
