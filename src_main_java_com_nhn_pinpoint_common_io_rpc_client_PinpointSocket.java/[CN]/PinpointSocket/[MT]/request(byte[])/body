{
  if (bytes == null) {
    throw new NullPointerException("bytes");
  }
  ensureOpen();
  RequestPacket request=new RequestPacket(bytes);
  final DefaultFuture<ResponseMessage> messageFuture=this.requestResponseManager.register(request,this.timeoutMillis);
  ChannelFuture write=this.channel.write(request);
  write.addListener(new ChannelFutureListener(){
    @Override public void operationComplete(    ChannelFuture future) throws Exception {
      if (!future.isSuccess()) {
        Throwable cause=future.getCause();
        messageFuture.setFailure(cause);
      }
    }
  }
);
  return messageFuture;
}
