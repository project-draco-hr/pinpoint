{
  final TestClassLoader loader=getTestClassLoader();
  final String testClassObject="com.navercorp.pinpoint.profiler.interceptor.bci.TestObject3";
  final FieldSnooper snooper=FieldSnooper.get(0);
  final TestModifier testModifier=new TestModifier(loader.getInstrumentor(),loader.getProfilerConfig()){
    @Override public byte[] modify(    ClassLoader classLoader,    String className,    ProtectionDomain protectedDomain,    byte[] classFileBuffer){
      try {
        logger.info("modify cl:{}",classLoader);
        InstrumentClass aClass=byteCodeInstrumentor.getClass(classLoader,testClassObject,classFileBuffer);
        aClass.addGetter(snooper.getType(),"value");
        return aClass.toBytecode();
      }
 catch (      InstrumentException e) {
        throw new RuntimeException(e.getMessage(),e);
      }
    }
  }
;
  testModifier.setTargetClass(testClassObject);
  loader.addModifier(testModifier);
  loader.initialize();
  Object testObject=loader.loadClass(testClassObject).newInstance();
  Assert.assertTrue(snooper.isApplicable(testObject));
  String value="hehe";
  Method method=testObject.getClass().getMethod("setValue",String.class);
  method.invoke(testObject,value);
  Assert.assertEquals(value,snooper.get(testObject));
}
