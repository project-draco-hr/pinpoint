{
  final TestClassLoader loader=getTestClassLoader();
  final String testClassObject="com.navercorp.pinpoint.profiler.interceptor.bci.TestObject3";
  final FieldAccessor accessor0=FieldAccessor.get(0);
  final FieldAccessor accessor1=FieldAccessor.get(1);
  final TestModifier testModifier=new TestModifier(loader.getInstrumentor(),loader.getProfilerConfig()){
    @Override public byte[] modify(    ClassLoader classLoader,    String className,    ProtectionDomain protectedDomain,    byte[] classFileBuffer){
      try {
        logger.info("modify cl:{}",classLoader);
        InstrumentableClass aClass=byteCodeInstrumentor.getClass(classLoader,testClassObject,classFileBuffer);
        aClass.addGetter(accessor0.getType(),"value");
        aClass.addGetter(accessor1.getType(),"intValue");
        return aClass.toBytecode();
      }
 catch (      InstrumentException e) {
        throw new RuntimeException(e.getMessage(),e);
      }
    }
  }
;
  testModifier.setTargetClass(testClassObject);
  loader.addModifier(testModifier);
  loader.initialize();
  Object testObject=loader.loadClass(testClassObject).newInstance();
  Assert.assertTrue(accessor0.isApplicable(testObject));
  Assert.assertTrue(accessor1.isApplicable(testObject));
  String value="hehe";
  int intValue=99;
  Method method=testObject.getClass().getMethod("setValue",String.class);
  method.invoke(testObject,value);
  Assert.assertEquals(value,accessor0.get(testObject));
  Method setIntValue=testObject.getClass().getMethod("setIntValue",int.class);
  setIntValue.invoke(testObject,intValue);
  Assert.assertEquals(intValue,accessor1.get(testObject));
}
