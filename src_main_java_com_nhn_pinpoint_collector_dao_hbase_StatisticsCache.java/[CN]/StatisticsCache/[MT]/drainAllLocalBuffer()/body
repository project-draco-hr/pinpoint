{
  try {
    logger.debug("drain all local buffer");
    bufferListLock.lock();
    for (    Map<Key,Value> buffer : bufferList) {
      if (buffer == null) {
        continue;
      }
      addValues(buffer);
      buffer.clear();
    }
  }
 catch (  Exception e) {
    logger.error(e.getMessage(),e);
  }
 finally {
    bufferListLock.unlock();
  }
}
