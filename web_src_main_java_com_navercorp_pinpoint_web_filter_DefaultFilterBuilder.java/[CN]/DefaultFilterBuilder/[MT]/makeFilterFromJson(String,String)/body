{
  if (StringUtils.isEmpty(jsonFilterText)) {
    throw new IllegalArgumentException("json string is empty");
  }
  FilterChain chain=new FilterChain();
  try {
    List<FilterDescriptor> list=jsonObjectMapper.readValue(jsonFilterText,new TypeReference<List<FilterDescriptor>>(){
    }
);
    FilterHint hint=jsonObjectMapper.readValue(jsonFilterHint,new TypeReference<FilterHint>(){
    }
);
    for (    FilterDescriptor descriptor : list) {
      if (!descriptor.isValid()) {
        throw new IllegalArgumentException("invalid json " + jsonFilterText);
      }
      logger.debug("FilterDescriptor={}",descriptor);
      chain.addFilter(new FromToResponseFilter(descriptor,hint));
      if (descriptor.isSetUrl()) {
        FromToFilter fromToFilter=new FromToFilter(descriptor.getFromServiceType(),descriptor.getFromApplicationName(),descriptor.getToServiceType(),descriptor.getToApplicationName());
        Filter urlPatternFilter=new URLPatternFilter(fromToFilter,descriptor.getUrlPattern());
        chain.addFilter(urlPatternFilter);
      }
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e.getMessage(),e);
  }
  return chain.get();
}
