{
  if (pinpointSocketFactory == null) {
    throw new NullPointerException("pinpointSocketFactory must not be null");
  }
  HashedWheelTimer timer=TimerFactory.createHashedWheelTimer("Pinpoint-SocketHandler-Timer",100,TimeUnit.MILLISECONDS,512);
  timer.start();
  this.channelTimer=timer;
  this.pinpointSocketFactory=pinpointSocketFactory;
  this.requestManager=new RequestManager(timer);
  this.pingDelay=pingDelay;
  this.handshakeRetryInterval=handshakeRetryInterval;
  this.timeoutMillis=timeoutMillis;
  MessageListener messageLisener=pinpointSocketFactory.getMessageListener();
  if (messageLisener != null) {
    this.messageListener=messageLisener;
  }
 else {
    this.messageListener=SimpleLoggingMessageListener.LISTENER;
  }
  ServerStreamChannelMessageListener serverStreamChannelMessageListener=pinpointSocketFactory.getServerStreamChannelMessageListener();
  if (serverStreamChannelMessageListener != null) {
    this.serverStreamChannelMessageListener=serverStreamChannelMessageListener;
  }
 else {
    this.serverStreamChannelMessageListener=DisabledServerStreamChannelMessageListener.INSTANCE;
  }
  pinpointSocketFactory.getServerStreamChannelMessageListener();
  this.handshaker=new PinpointClientSocketHandshaker(channelTimer,(int)handshakeRetryInterval,maxHandshakeCount);
}
