{
  logger.debug("close() call");
  int currentState=this.state.getState();
  if (currentState == State.CLOSED) {
    logger.debug("already close()");
    return;
  }
  logger.debug("close() start");
  if (!this.state.changeToClosed(currentState)) {
    logger.info("close() invalid state");
    return;
  }
  logger.debug("close() state change complete");
  final Channel channel=this.channel;
  closeStreamChannelManager(channel);
  sendClosedPacket(channel);
  logger.debug("channel.close()");
  ChannelFuture closeFuture=channel.close();
  closeFuture.addListener(new WriteFailFutureListener(logger,"close() event failed.","close() event success."));
  closeFuture.awaitUninterruptibly();
  logger.debug("close() complete");
}
