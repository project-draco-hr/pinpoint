{
  ChannelContext context=socketManager.getCollectorChannelContext(applicationName,agentId,startTimeStamp);
  if (context == null) {
    return createResponse(false,String.format("Can't find suitable ChannelContext(%s/%s/%d).",applicationName,agentId,startTimeStamp));
  }
  TCommandEcho echo=new TCommandEcho();
  echo.setMessage(message);
  byte[] payload=serialize(echo);
  TCommandTransfer transfer=new TCommandTransfer();
  transfer.setApplicationName(applicationName);
  transfer.setAgentId(agentId);
  transfer.setPayload(payload);
  Future<ResponseMessage> future=context.getSocketChannel().sendRequestMessage(serialize(transfer));
  future.await();
  String exceptionMessage=StringUtils.EMPTY;
  ResponseMessage responseMessage=future.getResult();
  try {
    TBase result=deserialize(responseMessage.getMessage());
    if (result == null) {
      return createResponse(false,String.format("Can't get message from %s.",context));
    }
 else     if (result instanceof TCommandEcho) {
      return createResponse(true,((TCommandEcho)result).getMessage());
    }
 else     if (result instanceof TResult) {
      return createResponse(false,((TResult)result).getMessage());
    }
 else {
      return createResponse(false,result.toString());
    }
  }
 catch (  TException e) {
    exceptionMessage=e.getMessage();
  }
  return createResponse(false,exceptionMessage);
}
