{
  if (responseDataSource == null) {
    throw new NullPointerException("responseDataSource must not be null");
  }
  final Collection<Node> nodes=this.nodeList.getNodeList();
  for (  Node node : nodes) {
    if (node.getServiceType().isWas()) {
      final Application application=new Application(node.getApplication().getName(),node.getServiceType());
      ResponseHistogramSummary nodeHistogramSummary=responseDataSource.getResponseHistogramSummary(application);
      node.setResponseHistogramSummary(nodeHistogramSummary);
    }
 else     if (node.getServiceType().isTerminal() || node.getServiceType().isUnknown()) {
      Application nodeApplication=new Application(node.getApplication().getName(),node.getServiceType());
      final ResponseHistogramSummary nodeHistogramSummary=new ResponseHistogramSummary(nodeApplication,range);
      Collection<Link> linkList=this.linkList.getLinks();
      for (      Link link : linkList) {
        Node toNode=link.getTo();
        String applicationName=toNode.getApplication().getName();
        ServiceType serviceType=toNode.getServiceType();
        Application destination=new Application(applicationName,serviceType);
        if (nodeApplication.equals(destination)) {
          Histogram linkHistogram=link.getHistogram();
          nodeHistogramSummary.addLinkHistogram(linkHistogram);
        }
      }
      node.setResponseHistogramSummary(nodeHistogramSummary);
    }
 else     if (node.getServiceType().isUser()) {
      Application nodeApplication=new Application(node.getApplication().getName(),node.getServiceType());
      final ResponseHistogramSummary nodeHistogramSummary=new ResponseHistogramSummary(nodeApplication,range);
      Collection<Link> linkList=this.linkList.getLinks();
      for (      Link link : linkList) {
        Node fromNode=link.getFrom();
        String applicationName=fromNode.getApplication().getName();
        ServiceType serviceType=fromNode.getServiceType();
        Application source=new Application(applicationName,serviceType);
        if (nodeApplication.equals(source)) {
          logger.debug("nodeApplication:{}, source:{}",nodeApplication,source);
          Histogram linkHistogram=link.getTargetHistogram();
          nodeHistogramSummary.addLinkHistogram(linkHistogram);
        }
      }
      node.setResponseHistogramSummary(nodeHistogramSummary);
    }
 else {
      Application nodeApplication=new Application(node.getApplication().getName(),node.getServiceType());
      ResponseHistogramSummary dummy=new ResponseHistogramSummary(nodeApplication,range);
      node.setResponseHistogramSummary(dummy);
    }
  }
}
