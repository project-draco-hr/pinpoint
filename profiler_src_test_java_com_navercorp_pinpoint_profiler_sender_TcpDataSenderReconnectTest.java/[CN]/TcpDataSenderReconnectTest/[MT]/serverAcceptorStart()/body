{
  PinpointServerAcceptor serverAcceptor=new PinpointServerAcceptor();
  serverAcceptor.setMessageListener(new ServerMessageListener(){
    @Override public void handleSend(    SendPacket sendPacket,    PinpointServer pinpointServer){
      logger.info("handleSend:{}",sendPacket);
      send++;
    }
    @Override public void handleRequest(    RequestPacket requestPacket,    PinpointServer pinpointServer){
      logger.info("handleRequest:{}",requestPacket);
    }
    @Override public HandshakeResponseCode handleHandshake(    Map properties){
      return HandshakeResponseType.Success.DUPLEX_COMMUNICATION;
    }
    @Override public void handlePing(    PingPacket pingPacket,    PinpointServer pinpointServer){
      logger.info("ping received {} {} ",pingPacket,pinpointServer);
    }
  }
);
  serverAcceptor.bind(HOST,PORT);
  return serverAcceptor;
}
