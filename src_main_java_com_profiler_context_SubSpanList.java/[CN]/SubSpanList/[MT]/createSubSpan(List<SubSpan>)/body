{
  List<com.profiler.common.dto.thrift.SubSpan> result=new ArrayList<com.profiler.common.dto.thrift.SubSpan>(subSpanList.size());
  for (  SubSpan subSpan : subSpanList) {
    com.profiler.common.dto.thrift.SubSpan tSubSpan=new com.profiler.common.dto.thrift.SubSpan();
    tSubSpan.setAgentId(Agent.getInstance().getAgentId());
    long parentSpanStartTime=subSpan.getParentSpan().getStartTime();
    tSubSpan.setStartElapsed((int)(subSpan.getStartTime() - parentSpanStartTime));
    tSubSpan.setEndElapsed((int)(subSpan.getEndTime() - subSpan.getStartTime()));
    tSubSpan.setSequence(subSpan.getSequence());
    tSubSpan.setRpc(subSpan.getRpc());
    tSubSpan.setServiceName(subSpan.getServiceName());
    tSubSpan.setServiceType(subSpan.getServiceType().getCode());
    tSubSpan.setEndPoint(subSpan.getEndPoint());
    List<com.profiler.common.dto.thrift.Annotation> annotationList=new ArrayList<com.profiler.common.dto.thrift.Annotation>(subSpan.getAnnotationSize());
    for (    Annotation a : subSpan.getAnnotations()) {
      annotationList.add(a.toThrift());
    }
    if (subSpan.getDepth() != -1) {
      tSubSpan.setDepth(subSpan.getDepth());
    }
    if (subSpan.getNextSpanId() != -1) {
      tSubSpan.setNextSpanId(subSpan.getNextSpanId());
    }
    tSubSpan.setAnnotations(annotationList);
    result.add(tSubSpan);
  }
  return result;
}
