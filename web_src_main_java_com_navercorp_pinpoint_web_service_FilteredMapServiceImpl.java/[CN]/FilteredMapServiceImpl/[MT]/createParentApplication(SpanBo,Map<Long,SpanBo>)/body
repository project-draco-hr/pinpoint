{
  final SpanBo parentSpan=transactionSpanMap.get(span.getParentSpanId());
  if (span.isRoot() || parentSpan == null) {
    String applicationName=span.getApplicationId();
    ServiceType serviceType=ServiceType.USER;
    return new Application(applicationName,serviceType);
  }
 else {
    String parentApplicationName=parentSpan.getApplicationId();
    ServiceType serviceType=registry.findServiceType(parentSpan.getApplicationServiceType());
    return new Application(parentApplicationName,serviceType);
  }
}
