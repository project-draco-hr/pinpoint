{
  if (!child) {
    final TAgentKey tAgentKey=DefaultAgent.getInstance().getTAgentKey();
    this.setAgentKey(tAgentKey);
    this.setParentServiceType(span.getServiceType());
    this.setParentEndPoint(span.getEndPoint());
    this.setTraceAgentId(span.getTraceAgentId());
    this.setTraceAgentStartTime(span.getTraceAgentStartTime());
    this.setTraceTransactionSequence(span.getTraceTransactionSequence());
    this.setSpanId(span.getSpanId());
  }
  if (traceAnnotationList != null) {
    List<TAnnotation> annotationList=new ArrayList<TAnnotation>(traceAnnotationList.size());
    for (    TraceAnnotation traceAnnotation : traceAnnotationList) {
      annotationList.add(traceAnnotation.toThrift());
    }
    this.setAnnotations(annotationList);
    this.traceAnnotationList=null;
  }
  return this;
}
